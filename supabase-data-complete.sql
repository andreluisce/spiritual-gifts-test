-- =========================================================
-- SISTEMA DE DONS ESPIRITUAIS – SCHEMA + DADOS COMPLETOS DO PDF
-- Postgres/Supabase – Idempotente (seguro para re-execução)
-- =========================================================

-- ---------- Extensões ----------
create extension if not exists pgcrypto with schema public;
create extension if not exists pgjwt with schema public;

-- ---------- Enums ----------
do $$
begin
  if not exists (
    select 1 from pg_type t join pg_namespace n on n.oid=t.typnamespace
    where t.typname='gift_key' and n.nspname='public'
  ) then
    create type public.gift_key as enum (
      'A_PROPHECY','B_SERVICE','C_TEACHING','D_EXHORTATION','E_GIVING','F_LEADERSHIP','G_MERCY'
    );
  end if;
end$$;

do $$
begin
  if not exists (
    select 1 from pg_type t join pg_namespace n on n.oid=t.typnamespace
    where t.typname='quiz_trait' and n.nspname='public'
  ) then
    create type public.quiz_trait as enum ('A','B','C','D','E','F','G','H','I');
  end if;
end$$;

-- ---------- Helper Functions ----------
create or replace function public.trigger_set_timestamp()
returns trigger language plpgsql as $$
begin
  new.updated_at = timezone('utc', now());
  return new;
end$$;

-- =========================================================
-- PROFILES
-- =========================================================
create table if not exists public.profiles (
  id uuid primary key references auth.users(id) on delete cascade,
  full_name text,
  avatar_url text,
  created_at timestamptz not null default timezone('utc', now()),
  updated_at timestamptz not null default timezone('utc', now())
);

do $$
begin
  if not exists (select 1 from pg_trigger where tgname='profiles_set_timestamp') then
    create trigger profiles_set_timestamp
      before update on public.profiles
      for each row execute function public.trigger_set_timestamp();
  end if;
end$$;

alter table public.profiles enable row level security;

do $$
begin
  if not exists (select 1 from pg_policies where policyname='profiles_select_own' and tablename='profiles') then
    create policy profiles_select_own on public.profiles for select using (id = auth.uid());
  end if;
  if not exists (select 1 from pg_policies where policyname='profiles_update_own' and tablename='profiles') then
    create policy profiles_update_own on public.profiles for update using (id = auth.uid());
  end if;
  if not exists (select 1 from pg_policies where policyname='profiles_insert_self' and tablename='profiles') then
    create policy profiles_insert_self on public.profiles for insert with check (id = auth.uid());
  end if;
end$$;

create or replace function public.handle_new_user()
returns trigger language plpgsql security definer as $$
begin
  insert into public.profiles(id) values (new.id) on conflict (id) do nothing;
  return new;
end$$;

do $$
begin
  if not exists (select 1 from pg_trigger where tgname='on_auth_user_created') then
    create trigger on_auth_user_created
      after insert on auth.users
      for each row execute function public.handle_new_user();
  end if;
end$$;

-- =========================================================
-- SCHEMA TABLES
-- =========================================================
create table if not exists public.categories (
  id int generated by default as identity primary key,
  name varchar(50) not null unique,
  greek_term varchar(50),
  description text,
  purpose text
);

create table if not exists public.spiritual_gifts (
  id int generated by default as identity primary key,
  category_id int references public.categories(id),
  name varchar(100) not null,
  definition text,
  biblical_references varchar(200),
  unique(category_id, name)
);

create table if not exists public.qualities (
  id int generated by default as identity primary key,
  gift_id int references public.spiritual_gifts(id) on delete cascade,
  quality_name varchar(100) not null,
  description text,
  order_sequence int,
  unique(gift_id, order_sequence)
);

create table if not exists public.characteristics (
  id int generated by default as identity primary key,
  gift_id int references public.spiritual_gifts(id) on delete cascade,
  characteristic text not null,
  order_sequence int,
  unique(gift_id, order_sequence)
);

create table if not exists public.dangers (
  id int generated by default as identity primary key,
  gift_id int references public.spiritual_gifts(id) on delete cascade,
  danger text not null,
  order_sequence int,
  unique(gift_id, order_sequence)
);

create table if not exists public.misunderstandings (
  id int generated by default as identity primary key,
  gift_id int references public.spiritual_gifts(id) on delete cascade,
  misunderstanding text not null,
  order_sequence int,
  unique(gift_id, order_sequence)
);

create table if not exists public.ministries (
  id int generated by default as identity primary key,
  name varchar(100) not null unique,
  definition text,
  biblical_references varchar(200),
  type text check (type in ('PRIMARY','OTHER')) default 'OTHER'
);

create table if not exists public.manifestations (
  id int generated by default as identity primary key,
  name varchar(100) not null unique,
  definition text,
  classification text check (classification in ('DISCERNIMENTO','PODER','DECLARACAO')),
  biblical_references varchar(200)
);

create table if not exists public.manifestation_principles (
  id int generated by default as identity primary key,
  principle text not null,
  order_sequence int,
  unique(order_sequence)
);

create table if not exists public.biblical_activities (
  id int generated by default as identity primary key,
  activity_name varchar(100) not null unique,
  biblical_reference varchar(100),
  biblical_text text
);

-- QUIZ TABLES
create table if not exists public.questions (
  id smallint primary key check (id between 1 and 45),
  text text not null
);

create table if not exists public.question_trait_map (
  question_id smallint primary key references public.questions(id) on delete cascade,
  trait public.quiz_trait not null
);

create table if not exists public.question_gift_map (
  question_id smallint primary key references public.questions(id) on delete cascade,
  gift public.gift_key not null
);

create table if not exists public.quiz_sessions (
  id uuid primary key default gen_random_uuid(),
  user_id uuid not null references auth.users(id) on delete cascade,
  created_at timestamptz not null default timezone('utc', now()),
  completed_at timestamptz
);

create table if not exists public.answers (
  session_id uuid not null references public.quiz_sessions(id) on delete cascade,
  question_id smallint not null references public.questions(id) on delete restrict,
  score smallint not null check (score between 0 and 3),
  created_at timestamptz not null default timezone('utc', now()),
  primary key (session_id, question_id)
);

create table if not exists public.gift_bridge (
  gift public.gift_key primary key,
  spiritual_gift_id int not null references public.spiritual_gifts(id) on delete restrict
);

create table if not exists public.gifts (
  key public.gift_key primary key,
  name text not null,
  description text
);

-- RLS
alter table public.quiz_sessions enable row level security;
alter table public.answers enable row level security;

do $$
begin
  if not exists (select 1 from pg_policies where tablename='quiz_sessions' and policyname='quiz_sessions_select_own') then
    create policy quiz_sessions_select_own on public.quiz_sessions for select using (user_id = auth.uid());
  end if;
  if not exists (select 1 from pg_policies where tablename='quiz_sessions' and policyname='quiz_sessions_insert_self') then
    create policy quiz_sessions_insert_self on public.quiz_sessions for insert with check (user_id = auth.uid());
  end if;
  if not exists (select 1 from pg_policies where tablename='quiz_sessions' and policyname='quiz_sessions_update_own') then
    create policy quiz_sessions_update_own on public.quiz_sessions for update using (user_id = auth.uid());
  end if;
  if not exists (select 1 from pg_policies where tablename='quiz_sessions' and policyname='quiz_sessions_delete_own') then
    create policy quiz_sessions_delete_own on public.quiz_sessions for delete using (user_id = auth.uid());
  end if;
  if not exists (select 1 from pg_policies where tablename='answers' and policyname='answers_select_own_session') then
    create policy answers_select_own_session on public.answers for select
      using (exists (select 1 from public.quiz_sessions s where s.id=session_id and s.user_id=auth.uid()));
  end if;
  if not exists (select 1 from pg_policies where tablename='answers' and policyname='answers_insert_own_session') then
    create policy answers_insert_own_session on public.answers for insert
      with check (exists (select 1 from public.quiz_sessions s where s.id=session_id and s.user_id=auth.uid()));
  end if;
  if not exists (select 1 from pg_policies where tablename='answers' and policyname='answers_update_own_session') then
    create policy answers_update_own_session on public.answers for update
      using (exists (select 1 from public.quiz_sessions s where s.id=session_id and s.user_id=auth.uid()));
  end if;
  if not exists (select 1 from pg_policies where tablename='answers' and policyname='answers_delete_own_session') then
    create policy answers_delete_own_session on public.answers for delete
      using (exists (select 1 from public.quiz_sessions s where s.id=session_id and s.user_id=auth.uid()));
  end if;
end$$;

-- =========================================================
-- VIEWS & FUNCTIONS
-- =========================================================
create or replace view public.quiz_results as
select a.session_id, m.gift, sum(a.score)::int as total
from public.answers a
join public.question_gift_map m on m.question_id = a.question_id
where m.gift in ('A_PROPHECY','B_SERVICE','C_TEACHING','D_EXHORTATION','E_GIVING','F_LEADERSHIP','G_MERCY')
group by a.session_id, m.gift;

create or replace function public.calculate_quiz_result(p_session_id uuid)
returns table (gift public.gift_key, total int)
language sql stable as $$
  select m.gift, sum(a.score)::int as total
  from public.answers a
  join public.question_gift_map m on m.question_id = a.question_id
  where a.session_id = p_session_id
    and m.gift in ('A_PROPHECY','B_SERVICE','C_TEACHING','D_EXHORTATION','E_GIVING','F_LEADERSHIP','G_MERCY')
  group by m.gift
  order by total desc, m.gift asc;
$$;

create or replace function public.best_gifts(p_session_id uuid, p_limit int default 3)
returns table (gift public.gift_key, total int)
language sql stable as $$
  select gift, total
  from public.calculate_quiz_result(p_session_id)
  order by total desc, gift asc
  limit greatest(p_limit,1);
$$;

create or replace function public.finalize_session_if_complete()
returns trigger language plpgsql as $$
declare answered int;
begin
  select count(*) into answered from public.answers where session_id = coalesce(new.session_id, old.session_id);
  if answered >= 45 then
    update public.quiz_sessions
      set completed_at = coalesce(completed_at, timezone('utc', now()))
      where id = coalesce(new.session_id, old.session_id);
  end if;
  return null;
end$$;

do $$
begin
  if not exists (select 1 from pg_trigger where tgname='answers_finalize_session') then
    create trigger answers_finalize_session
      after insert or update or delete on public.answers
      for each row execute function public.finalize_session_if_complete();
  end if;
end$$;

create or replace view public.quiz_results_motivations_details as
select r.session_id, r.gift, gb.spiritual_gift_id, sg.name as gift_name,
       sg.definition as gift_definition, r.total
from public.quiz_results r
left join public.gift_bridge gb on gb.gift = r.gift
left join public.spiritual_gifts sg on sg.id = gb.spiritual_gift_id
order by r.total desc, r.gift asc;

-- =========================================================
-- DATA SEEDING - COMPLETO DO PDF
-- =========================================================

-- Categorias
insert into public.categories(name, greek_term, description, purpose) values
  ('MOTIVAÇÕES','Karismation','Impulso básico implantado no interior de cada cristão para que Deus expresse Seu amor','Para cada indivíduo ter e segurar'),
  ('MINISTÉRIOS','Diakonion','Serviço cristão que Deus determina para cada um, para exercer sua motivação','Para a Igreja'),
  ('MANIFESTAÇÕES','Energias planerosis','Manifestações do Espírito para capacitar no ministério','Para indivíduos momentaneamente')
on conflict (name) do update
set greek_term=excluded.greek_term, description=excluded.description, purpose=excluded.purpose;

-- Dons Espirituais (7 Motivações)
do $$
declare
  motivacao_cat_id int;
begin
  select id into motivacao_cat_id from public.categories where name = 'MOTIVAÇÕES';
  
  insert into public.spiritual_gifts(category_id,name,definition,biblical_references) values
    (motivacao_cat_id,'PROFECIA','A motivação divina a revelar motivos e ações injustas através da apresentação da verdade','Rm 12:3-8; 1Pe 4:10; 1Co 12:4'),
    (motivacao_cat_id,'MINISTÉRIO','Demonstrar amor suprindo necessidades práticas','Rm 12:3-8; 1Pe 4:10; 1Co 12:4'),
    (motivacao_cat_id,'ENSINO','Pesquisar, esclarecer e preparar material bíblico para outros','Rm 12:3-8; 1Pe 4:10; 1Co 12:4'),
    (motivacao_cat_id,'EXORTAÇÃO','Estimular a fé e aconselhar rumo à ação espiritual','Rm 12:3-8; 1Pe 4:10; 1Co 12:4'),
    (motivacao_cat_id,'CONTRIBUIÇÃO','Entregar recursos pessoais para expansão de ministérios','Rm 12:3-8; 1Pe 4:10; 1Co 12:4'),
    (motivacao_cat_id,'ADMINISTRAÇÃO','Coordenar atividades rumo a um alvo comum','Rm 12:3-8; 1Pe 4:10; 1Co 12:4'),
    (motivacao_cat_id,'MISERICÓRDIA','Identificar-se com aflitos para consolá-los','Rm 12:3-8; 1Pe 4:10; 1Co 12:4')
  on conflict (category_id,name) do update
  set definition=excluded.definition, biblical_references=excluded.biblical_references;
end$$;

-- Gift Bridge
do $$
begin
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'A_PROPHECY', sg.id from public.spiritual_gifts sg where upper(sg.name)='PROFECIA'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
  
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'B_SERVICE', sg.id from public.spiritual_gifts sg where upper(sg.name)='MINISTÉRIO'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
  
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'C_TEACHING', sg.id from public.spiritual_gifts sg where upper(sg.name)='ENSINO'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
  
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'D_EXHORTATION', sg.id from public.spiritual_gifts sg where upper(sg.name)='EXORTAÇÃO'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
  
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'E_GIVING', sg.id from public.spiritual_gifts sg where upper(sg.name)='CONTRIBUIÇÃO'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
  
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'F_LEADERSHIP', sg.id from public.spiritual_gifts sg where upper(sg.name)='ADMINISTRAÇÃO'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
  
  insert into public.gift_bridge(gift, spiritual_gift_id)
  select 'G_MERCY', sg.id from public.spiritual_gifts sg where upper(sg.name)='MISERICÓRDIA'
  on conflict (gift) do update set spiritual_gift_id=excluded.spiritual_gift_id;
end$$;

-- QUALIDADES COMPLETAS (7 para cada dom)
do $$
declare
  profecia_id int;
  ministerio_id int;
  ensino_id int;
  exortacao_id int;
  contribuicao_id int;
  administracao_id int;
  misericordia_id int;
begin
  select id into profecia_id from public.spiritual_gifts where name = 'PROFECIA';
  select id into ministerio_id from public.spiritual_gifts where name = 'MINISTÉRIO';
  select id into ensino_id from public.spiritual_gifts where name = 'ENSINO';
  select id into exortacao_id from public.spiritual_gifts where name = 'EXORTAÇÃO';
  select id into contribuicao_id from public.spiritual_gifts where name = 'CONTRIBUIÇÃO';
  select id into administracao_id from public.spiritual_gifts where name = 'ADMINISTRAÇÃO';
  select id into misericordia_id from public.spiritual_gifts where name = 'MISERICÓRDIA';

  -- PROFECIA - 7 qualidades
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (profecia_id,'Um relacionamento certo com Deus',1),
    (profecia_id,'Honestidade',2),
    (profecia_id,'Humildade',3),
    (profecia_id,'Entusiasmo pela sua mensagem',4),
    (profecia_id,'Amor pelo auditório',5),
    (profecia_id,'Sensibilidade para com os sentimentos do auditório',6),
    (profecia_id,'Autoconfiança',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- MINISTÉRIO - 7 qualidades  
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (ministerio_id,'Um desejo de trabalhar',1),
    (ministerio_id,'Disposição para aceitar responsabilidades',2),
    (ministerio_id,'Iniciativa de reconhecer serviços que precisam ser feitos',3),
    (ministerio_id,'Uma afeição e desejo para servir a outros',4),
    (ministerio_id,'Resistência',5),
    (ministerio_id,'Alegria',6),
    (ministerio_id,'Humildade',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- ENSINO - 7 qualidades
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (ensino_id,'Humildade',1),
    (ensino_id,'Sinceridade e honestidade',2),
    (ensino_id,'Conscientização e escrupulosidade',3),
    (ensino_id,'Organização',4),
    (ensino_id,'Otimismo',5),
    (ensino_id,'Discernimento',6),
    (ensino_id,'Paciência',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- EXORTAÇÃO - 7 qualidades
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (exortacao_id,'Humildade',1),
    (exortacao_id,'Disponibilidade',2),
    (exortacao_id,'Relação certa com Deus e um andar no Espírito',3),
    (exortacao_id,'Paciência',4),
    (exortacao_id,'Disposição para ouvir',5),
    (exortacao_id,'Otimismo',6),
    (exortacao_id,'Diplomacia',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- CONTRIBUIÇÃO - 7 qualidades
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (contribuicao_id,'Amor verdadeiro pelos outros',1),
    (contribuicao_id,'Interesse na obra de Deus',2),
    (contribuicao_id,'Discernimento',3),
    (contribuicao_id,'Sensibilidade à direção de Deus',4),
    (contribuicao_id,'Atitude imaterialista',5),
    (contribuicao_id,'Desejo de dar',6),
    (contribuicao_id,'Humildade',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- ADMINISTRAÇÃO - 7 qualidades
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (administracao_id,'Sabedoria (compreensão das áreas chaves da vida)',1),
    (administracao_id,'Integridade (pureza de coração e honestidade exterior)',2),
    (administracao_id,'Humildade (visão exata e correta de si mesmo e de seu ministério)',3),
    (administracao_id,'Dedicação (disciplina dirigida de si mesmo em seu ministério)',4),
    (administracao_id,'Confiança (saber que pode enfrentar qualquer situação que se apresente, com sucesso)',5),
    (administracao_id,'Visão (vendo o quadro todo e planejando criativa e realisticamente para o futuro)',6),
    (administracao_id,'Decisão (confiante e organizado em suas decisões)',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- MISERICÓRDIA - 7 qualidades
  insert into public.qualities(gift_id,quality_name,order_sequence) values
    (misericordia_id,'Interesse e aceitação pelos outros',1),
    (misericordia_id,'Humildade',2),
    (misericordia_id,'Sinceridade',3),
    (misericordia_id,'Paciência',4),
    (misericordia_id,'Sensibilidade',5),
    (misericordia_id,'Empatia',6),
    (misericordia_id,'Alegria',7)
  on conflict (gift_id,order_sequence) do nothing;
end$$;

-- CARACTERÍSTICAS COMPLETAS (do PDF)
do $$
declare
  profecia_id int;
  ministerio_id int;
  ensino_id int;
  exortacao_id int;
  contribuicao_id int;
  administracao_id int;
  misericordia_id int;
begin
  select id into profecia_id from public.spiritual_gifts where name = 'PROFECIA';
  select id into ministerio_id from public.spiritual_gifts where name = 'MINISTÉRIO';
  select id into ensino_id from public.spiritual_gifts where name = 'ENSINO';
  select id into exortacao_id from public.spiritual_gifts where name = 'EXORTAÇÃO';
  select id into contribuicao_id from public.spiritual_gifts where name = 'CONTRIBUIÇÃO';
  select id into administracao_id from public.spiritual_gifts where name = 'ADMINISTRAÇÃO';
  select id into misericordia_id from public.spiritual_gifts where name = 'MISERICÓRDIA';

  -- PROFECIA - 12 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (profecia_id,'Sente necessidade de expressar sua mensagem, verbalmente',1),
    (profecia_id,'Tem capacidade de discernir os motivos e o caráter dos outros',2),
    (profecia_id,'Tem capacidade de identificar, definir e odiar o mal',3),
    (profecia_id,'Está sempre pronto a experimentar quebrantamento para produzi-lo em outros',4),
    (profecia_id,'Depende das escrituras para validar sua autoridade',5),
    (profecia_id,'Procura evidências externas que demonstrem convicção interna',6),
    (profecia_id,'Usa de exatidão, franqueza e persuasão no falar',7),
    (profecia_id,'Tem zelo pela reputação e obra de Deus',8),
    (profecia_id,'Identifica-se e entristece-se com os pecados daqueles que assiste',9),
    (profecia_id,'Enxerga tudo como sendo certo ou errado, branco ou preto',10),
    (profecia_id,'Acredita que existe uma lógica para tudo',11),
    (profecia_id,'Provavelmente seja uma pessoa autoconfiante com habilidade para estar à vontade em frente a um grupo',12)
  on conflict (gift_id,order_sequence) do nothing;

  -- MINISTÉRIO - 17 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (ministerio_id,'Tem capacidade de lembrar do que os outros gostam ou não',1),
    (ministerio_id,'Está sempre atento às necessidades práticas. Prefere o trabalho manual a outro',2),
    (ministerio_id,'Impulsionado a suprir as necessidades o mais breve possível',3),
    (ministerio_id,'É de resistência física suficiente para suprir estas necessidades sem pensar no cansaço',4),
    (ministerio_id,'Está disposto a usar recursos próprios para evitar demora',5),
    (ministerio_id,'Deseja perceber gratidão sincera e é capaz de perceber insinceridade; quando esta ocorre, às vezes resulta em ressentimento',6),
    (ministerio_id,'Está sempre envolvido em muitas atividades pelo fato se ser incapaz de dizer não',7),
    (ministerio_id,'Frustra-se quando se lhe impõe prazo determinado para um serviço',8),
    (ministerio_id,'Às vezes reage contra pessoas que não percebem e nem suprem necessidades óbvias',9),
    (ministerio_id,'Tem prazer em alvos presentes, mas sente-se frustrado com alvos futuros',10),
    (ministerio_id,'Sente-se realizado quando termina uma tarefa, mas quando não, miserável',11),
    (ministerio_id,'Normalmente é responsável e industrioso na questão de executar um serviço',12),
    (ministerio_id,'Normalmente é bom seguidor, sem desejo de liderar',13),
    (ministerio_id,'Procura oportunidade de servir – deleita-se em agradar e servir outros',14),
    (ministerio_id,'Normalmente é capaz e eficiente em serviço normal, principalmente em áreas que é especialista',15),
    (ministerio_id,'Quer sempre saber os detalhes de como certa tarefa precisa ser feita',16),
    (ministerio_id,'Realiza-se em cumprir tarefas manuais',17)
  on conflict (gift_id,order_sequence) do nothing;

  -- ENSINO - 13 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (ensino_id,'Crê que o dom que tem é fundamental em relação aos demais',1),
    (ensino_id,'Dá mais ênfase ao significado exato das palavras',2),
    (ensino_id,'Está sempre prevendo o conhecimento daqueles que ensina',3),
    (ensino_id,'Prazer na pesquisa, com vistas à confirmação da verdade',4),
    (ensino_id,'Procura confirmar pensamentos novos por meio de princípios',5),
    (ensino_id,'Apresenta a verdade de modo sistemático',6),
    (ensino_id,'Evita ilustrações de fonte extra bíblica',7),
    (ensino_id,'Opõe-se ao uso de ilustrações bíblicas fora do contexto',8),
    (ensino_id,'Sente maior prazer na pesquisa da verdade do que na apresentação da mesma',9),
    (ensino_id,'Quando obtém conhecimento, tem desejo de torna-lo prático e aplicável para si mesmo e para os outros',10),
    (ensino_id,'Questiona idéias e conceitos novos',11),
    (ensino_id,'Conhece os fatos e entende os princípios fundamentais a respeito destes',12),
    (ensino_id,'Entusiasma-se em acumular conhecimento, especialmente por causa do potencial que tem em transformar vidas',13)
  on conflict (gift_id,order_sequence) do nothing;

  -- EXORTAÇÃO - 14 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (exortacao_id,'Deseja a visualização de um alvo específico e determina passos definidos para alcança-lo',1),
    (exortacao_id,'Tenás a evitar princípios e crenças que não têm aplicação prática',2),
    (exortacao_id,'É capaz de ver na tribulação um meio de se elevar a níveis mais altos da maturidade',3),
    (exortacao_id,'Depende da aceitação perceptível, quando estiver falando a indivíduos ou grupos',4),
    (exortacao_id,'Descobre através da experiência humana, princípios que podem confirmar e ampliar pelas escrituras',5),
    (exortacao_id,'Tem prazer em lidar com pessoas dispostas a seguir a orientação dada',6),
    (exortacao_id,'Sente-se triste quando o conselho dele não resulta em ação',7),
    (exortacao_id,'Tem prazer em entrevistas pessoais que resultam no conhecimento de novos princípios práticos',8),
    (exortacao_id,'Tem prazer em encorajar e estimular a fé de outros',9),
    (exortacao_id,'Tem entusiasmo naquilo que acha ser a verdade',10),
    (exortacao_id,'Normalmente é uma pessoa bem aberta, que tem um forte interesse por outras pessoas',11),
    (exortacao_id,'Porque tem respostas pessoais, as pessoas são atraídas a ele',12),
    (exortacao_id,'Gosta de aplicar praticamente as verdades que aprende',13),
    (exortacao_id,'Capaz de visualizar o potencial espiritual de uma pessoa e sugerir passos de ação para realizar aquele potencial',14)
  on conflict (gift_id,order_sequence) do nothing;

  -- CONTRIBUIÇÃO - 12 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (contribuicao_id,'Tem capacidade de comprar e investir com sabedoria',1),
    (contribuicao_id,'Prefere contribuir para obras e projetos efetivos, contudo, sem publicidade',2),
    (contribuicao_id,'Com suas contribuições, procuram motivar outros a contribuir também',3),
    (contribuicao_id,'É sensível a necessidade que receia não serem vistos por outros',4),
    (contribuicao_id,'Tem prazer em suprir necessidades sem a pressão de apelos',5),
    (contribuicao_id,'Sente-se satisfeito quando a contribuição é resposta a uma oração específica',6),
    (contribuicao_id,'Depende do conselho de uma pessoa íntima para confirmar a quantia a ser dada',7),
    (contribuicao_id,'Deseja sentir-se participante da obra para que contribua',8),
    (contribuicao_id,'É generoso a respeito não somente do uso de seu dinheiro, mas provavelmente, também do seu tempo, bens, etc',9),
    (contribuicao_id,'Tem um interesse sincero nas necessidades de outras pessoas e demonstra o seu interesse com apoio material',10),
    (contribuicao_id,'Em vez de desejar adquirir muitos bens materiais, ele é satisfeito com pouco, mesmo que sua renda seja grande',11),
    (contribuicao_id,'Talvez tenha capacidade incomum para organizar suas finanças pessoais para adquirir grandes bens financeiros',12)
  on conflict (gift_id,order_sequence) do nothing;

  -- ADMINISTRAÇÃO - 14 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (administracao_id,'É capaz de ver claramente uma situação em seu todo e determinar alvos futuros',1),
    (administracao_id,'É motivado a organizar aquilo pelo que é responsável',2),
    (administracao_id,'Deseja completar um serviço o mais depressa possível',3),
    (administracao_id,'É consciente dos recursos disponíveis para se concluir a obra',4),
    (administracao_id,'Sabe qual serviço pode ou não mandar outros fazerem',5),
    (administracao_id,'Tende a ficar de lado até que a liderança lhe passe a responsabilidade',6),
    (administracao_id,'É tendente a assumir a liderança onde ela não existe',7),
    (administracao_id,'Está disposto a suportar reações negativas por parte daqueles que estão sob a sua responsabilidade para atinge o alvo já estabelecido',8),
    (administracao_id,'Sente-se realizado ao ver um projeto se completar e os outros satisfeitos',9),
    (administracao_id,'Deseja enfrentar logo um novo projeto, quando termina o anterior',10),
    (administracao_id,'É uma pessoa de visão tendo uma perspectiva total da obra ou projeto',11),
    (administracao_id,'Gosta e é capaz de assumir responsabilidades tremendas sobre seus ombros',12),
    (administracao_id,'Tem iniciativa e é capaz de inspirar pessoas com visão pela igreja ou obra',13),
    (administracao_id,'Capaz de fazer decisões autoritárias sem nenhum medo. Normalmente é uma pessoa autoconfiante',14)
  on conflict (gift_id,order_sequence) do nothing;

  -- MISERICÓRDIA - 13 características
  insert into public.characteristics(gift_id,characteristic,order_sequence) values
    (misericordia_id,'É capaz de perceber alegria ou tristeza num indivíduo ou grupo',1),
    (misericordia_id,'É atraído a pessoas problemáticas e pode entende-las muito bem',2),
    (misericordia_id,'Atenta mais para a cura de problemas psicológicos e espirituais do que físicos',3),
    (misericordia_id,'Evita ser austero quando ignora os benefícios decorrentes de tal posição',4),
    (misericordia_id,'Sensível ao uso de palavras, atitudes e ações que possam ferir os outros',5),
    (misericordia_id,'É capaz de discernir os motivos sinceros',6),
    (misericordia_id,'Identifica-se e sente prazer na companhia de quem é sensível às necessidades e sentimentos dos outros',7),
    (misericordia_id,'Fecha o coração a pessoas insinceros ou in sensíveis',8),
    (misericordia_id,'É relativamente livre para expressar suas emoções e sentimentos',9),
    (misericordia_id,'Tem um interesse verdadeiro nos outros e é pessoa orientada',10),
    (misericordia_id,'É disponível aos outros e não se sente incomodado ajudando-os',11),
    (misericordia_id,'Muito de seu falar é relacionado com pessoas, suas emoções, problemas e necessidades',12),
    (misericordia_id,'Normalmente ele é paciente com os outros e aceita-os com suas fraquezas',13)
  on conflict (gift_id,order_sequence) do nothing;
end$$;

-- PERIGOS COMPLETOS (do PDF)
do $$
declare
  profecia_id int;
  ministerio_id int;
  ensino_id int;
  exortacao_id int;
  contribuicao_id int;
  administracao_id int;
  misericordia_id int;
begin
  select id into profecia_id from public.spiritual_gifts where name = 'PROFECIA';
  select id into ministerio_id from public.spiritual_gifts where name = 'MINISTÉRIO';
  select id into ensino_id from public.spiritual_gifts where name = 'ENSINO';
  select id into exortacao_id from public.spiritual_gifts where name = 'EXORTAÇÃO';
  select id into contribuicao_id from public.spiritual_gifts where name = 'CONTRIBUIÇÃO';
  select id into administracao_id from public.spiritual_gifts where name = 'ADMINISTRAÇÃO';
  select id into misericordia_id from public.spiritual_gifts where name = 'MISERICÓRDIA';

  -- PROFECIA - 10 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (profecia_id,'Orgulhar-se de sua eloqüência e persuasão',1),
    (profecia_id,'Procurar sutilmente parecer importante ou sábio al falar diante de um grupo',2),
    (profecia_id,'Depender tanto de sua capacidade de falar em público a ponto de negligenciar na preparação adequada',3),
    (profecia_id,'Sentir tanto prazer em expor as ações e atividades do grupo, faltando-lhe uma sincera tristeza ou preocupação sobre seus pecados',4),
    (profecia_id,'Negligenciar a prática do que prega a ponto de anular o que falou',5),
    (profecia_id,'Preocupar-se com o que os outros pensam a seu respeito quando está falando',6),
    (profecia_id,'Falar em público só para tornar-se conhecido',7),
    (profecia_id,'Depender mais de sua eloqüência e raciocínio, em vez do poder convincente do Espírito Santo',8),
    (profecia_id,'Olhar as pessoas como um grupo e não como indivíduos com necessidades pessoais',9),
    (profecia_id,'Orgulhar-se de sua lógica e de sua retórica',10)
  on conflict (gift_id,order_sequence) do nothing;

  -- MINISTÉRIO - 11 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (ministerio_id,'Servir de um desejo para agradar ou receber elogios e não servir com um desejo de glorificar a Deus',1),
    (ministerio_id,'Pensar que seu som não é tão importante, conseqüentemente, poderá cobiçar as pessoas com dons mais clamorosos',2),
    (ministerio_id,'Respondendo às necessidades físicas poderá negligenciar as necessidades espirituais',3),
    (ministerio_id,'Relacionar-se com pessoas somente para fazer algo para elas, podendo falhar no cultivo de relacionamentos',4),
    (ministerio_id,'Usar de seu trabalho como uma desculpa para evitar esforçar-se mentalmente',5),
    (ministerio_id,'Porque gosta de servir aos outros poderá negligenciar sua responsabilidade para com sua família',6),
    (ministerio_id,'Aceitar mais responsabilidades do que deve para fazê-las bem',7),
    (ministerio_id,'Devido sua concentração ser mais com serviço manual, poderá não compreender as pessoas que tenham dons que tratem diretamente com as pessoas',8),
    (ministerio_id,'Ficar tão envolvido em projetos manuais e podendo ignorar as pessoas',9),
    (ministerio_id,'Reagir com frustração e irritação quando seu serviço está impedido através de complicações desnecessárias',10),
    (ministerio_id,'Ficar magoado quando os outros não reconhecem nem mostrarem gratidão pelas obras feitas',11)
  on conflict (gift_id,order_sequence) do nothing;

  -- ENSINO - 7 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (ensino_id,'Pode ficar orgulhoso por causa de seus conhecimentos e aprendizado',1),
    (ensino_id,'Pode sentir-se ameaçado quando não puder responder a uma pergunta de algum aluno',2),
    (ensino_id,'Pode parecer mais entendido do que realmente é',3),
    (ensino_id,'Quando estiver preparando, pode ser que concentre tanto na informação da pesquisa, esquecendo-se das necessidades práticas do aluno',4),
    (ensino_id,'Pode exibir uma atitude crítica e orgulhosa a outros indivíduos ou grupos, dos quais pensa que tem um conhecimento inferior da verdade',5),
    (ensino_id,'Quando enfrenta uma decisão poderá ficar tão preocupado em adquirir mais informações que hesitará em tomar uma decisão',6),
    (ensino_id,'Desprezar outros que não possuam sua meticulosidade',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- EXORTAÇÃO - 9 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (exortacao_id,'Ficar com os méritos dos resultados',1),
    (exortacao_id,'Procurar "aparecer"',2),
    (exortacao_id,'"Usar" as pessoas para obter seus resultados',3),
    (exortacao_id,'Projetar-se como líder de uma situação',4),
    (exortacao_id,'Faltar tato em confrontar os outros',5),
    (exortacao_id,'Ser tão ansioso para aconselhar, se esquecendo de escutar o seu aconselhado',6),
    (exortacao_id,'Ficar desanimado ou impaciente quando as pessoas que está aconselhando não responder ou responder devagar',7),
    (exortacao_id,'Dar conselhos demais para o aconselhando quando o melhor seria deixa-lo pensar e resolver o seu próprio problema',8),
    (exortacao_id,'Dar apenas conselhos quando a situação também exigir empatia e misericórdia',9)
  on conflict (gift_id,order_sequence) do nothing;

  -- CONTRIBUIÇÃO - 8 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (contribuicao_id,'Dar com motivos errados de querer receber recompensas, não visando primeiramente o amor de Cristo',1),
    (contribuicao_id,'Orgulhar-se em contribuir, sendo especialmente tentado a comparar sua atitude em dar, com a dos outros',2),
    (contribuicao_id,'Revelar a soma de sua contribuição para impressionar outros',3),
    (contribuicao_id,'Suprir necessidades pessoais imediatas de outros indiscriminadamente, quando seria melhor para o desenvolvimento dele, se ele não tivesse ajudado',4),
    (contribuicao_id,'Dar sem sensibilidade seu dinheiro pode ser mais usado para glorificar a Deus',5),
    (contribuicao_id,'Ser tentado a se considerar muito espiritual por dar sacrificialmente e negligenciar exercícios importantes como oração e estudo da Bíblia',6),
    (contribuicao_id,'Senti-se como mártir, pensando que ninguém aprecia o que ele está fazendo e que se não fosse ele a igreja cairia em pedaços, financeiramente',7),
    (contribuicao_id,'Julgar que não são espirituais aqueles que não contribuem como ele o faz',8)
  on conflict (gift_id,order_sequence) do nothing;

  -- ADMINISTRAÇÃO - 11 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (administracao_id,'Orgulhar-se de sua posição e capacidade de ter uma visão geral',1),
    (administracao_id,'Preocupar-se com idéias e tornar-se indiferente às necessidades das pessoas',2),
    (administracao_id,'Ditar ordens, em vez de servir',3),
    (administracao_id,'Ver pessoas como recursos para executar seus alvos em vez de vê-las como indivíduos com necessidades pessoais',4),
    (administracao_id,'Por causa da força da sua personalidade, é possível intimidar pessoas e tornar difícil para as mesmas em pensarem o que realmente sentem',5),
    (administracao_id,'Sua autoconfiança pode prejudicar uma confiança total em Deus',6),
    (administracao_id,'Não confiar naqueles com quem está trabalhando não delegando responsabilidades, tomando-as sobre seus próprios ombros',7),
    (administracao_id,'Ter uma atitude crítica com pessoas que não têm visão geral ou que falta iniciativa em sua vida',8),
    (administracao_id,'Não elogiar ou apreciar as pessoas que trabalham com ele',9),
    (administracao_id,'Separar-se um pouco do grupo e tender a deixa-los sentindo-se alienados dele',10),
    (administracao_id,'Reagir a uma atitude de uma pessoa mudando-a de serviço em vez de aconselha-la para resolver o problema básico',11)
  on conflict (gift_id,order_sequence) do nothing;

  -- MISERICÓRDIA - 10 perigos
  insert into public.dangers(gift_id,danger,order_sequence) values
    (misericordia_id,'Orgulha-se de sua capacidade de empatia',1),
    (misericordia_id,'Confiar plenamente em seus sentimentos e acha-los plenamente confiáveis',2),
    (misericordia_id,'Tomar decisões baseadas mais nas emoções do que na lógica',3),
    (misericordia_id,'Usar toda a sensibilidade que possui em seus problemas e em si mesmo',4),
    (misericordia_id,'Ver as pessoas que tem outros dons (especialmente profecia e exortação) como insensíveis às necessidades dos outros',5),
    (misericordia_id,'Confiar na sua própria capacidade de empatizar com os outros e não ser motivado pelo amor de Deus',6),
    (misericordia_id,'Não ter firmeza ao aconselhar ou confrontar quando isto for claramente preciso',7),
    (misericordia_id,'Empatizar-se (com alguém que não merece empatia). Dar exemplo tratando só de amargor que não querem mudar e se querem empatia emocional para ensinamentos livres',8),
    (misericordia_id,'Amargurar-se por causa do sofrimento ou sentimentos feitos no passado',9),
    (misericordia_id,'Retirar-se e ficar facilmente sentido em face à insensibilidade dos outros',10)
  on conflict (gift_id,order_sequence) do nothing;
end$$;

-- MAL-ENTENDIDOS COMPLETOS (do PDF)
do $$
declare
  profecia_id int;
  ministerio_id int;
  ensino_id int;
  exortacao_id int;
  contribuicao_id int;
  administracao_id int;
  misericordia_id int;
begin
  select id into profecia_id from public.spiritual_gifts where name = 'PROFECIA';
  select id into ministerio_id from public.spiritual_gifts where name = 'MINISTÉRIO';
  select id into ensino_id from public.spiritual_gifts where name = 'ENSINO';
  select id into exortacao_id from public.spiritual_gifts where name = 'EXORTAÇÃO';
  select id into contribuicao_id from public.spiritual_gifts where name = 'CONTRIBUIÇÃO';
  select id into administracao_id from public.spiritual_gifts where name = 'ADMINISTRAÇÃO';
  select id into misericordia_id from public.spiritual_gifts where name = 'MISERICÓRDIA';

  -- PROFECIA - 7 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (profecia_id,'A fraqueza pode ser vista como austeridade',1),
    (profecia_id,'O interesse por grupos talvez seja visto como desinteresse por indivíduos',2),
    (profecia_id,'Os esforços para conseguir resultados podem ser vistos como truques',3),
    (profecia_id,'A ênfase no certo ou errado pode ser considerado intolerância com o "mais ou menos"',4),
    (profecia_id,'A ênfase em decisões talvez pareça negligência ao desenvolvimento espiritual',5),
    (profecia_id,'A ousadia em público e os padrões elevados podem impedir relações pessoais',6),
    (profecia_id,'O forte desejo de comunicar a verdade, às vezes se interpreta como sendo pouco interesse em ouvir o ponto de vista dos outros',7)
  on conflict (gift_id,order_sequence) do nothing;

  -- MINISTÉRIO - 5 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (ministerio_id,'O suprimento rápido de necessidades talvez se julgue como ousadia',1),
    (ministerio_id,'A negligência às necessidades pessoais, às vezes atinge as necessidades de sua própria família',2),
    (ministerio_id,'A disposição de servir talvez se pode ver como promoção própria',3),
    (ministerio_id,'A insistência em servir talvez se veja como não querendo ser servido',4),
    (ministerio_id,'O suprimento rápido de necessidades pode impedir alguma lição espiritual que Deus esteja querendo aplicar à pessoa necessitada',5)
  on conflict (gift_id,order_sequence) do nothing;

  -- ENSINO - 5 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (ensino_id,'A ênfase na exatidão da interpretação das escrituras talvez dê a entender como negligência na aplicação prática',1),
    (ensino_id,'A persistência na pesquisa pode ser vista como substituição do ministério de ensino do Espírito Santo através da meditação na Palavra',2),
    (ensino_id,'O uso de conhecimento próprio para provar o dos outros talvez seja visto como orgulho',3),
    (ensino_id,'A preocupação com a comunicação de pormenores da pesquisa pode ser vista ou considerada como desnecessária',4),
    (ensino_id,'A necessidade de ser objetivo na pesquisa talvez faça da apresentação algo sem vida',5)
  on conflict (gift_id,order_sequence) do nothing;

  -- EXORTAÇÃO - 4 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (exortacao_id,'A ênfase em passos de ação pode ser entendida como não penetrando a fundo no problema',1),
    (exortacao_id,'A pressa em determinar um plano de ação pode ser vista como confiança demasiada nesse plano',2),
    (exortacao_id,'O uso de versículos bíblicos para aplicação prática pode ser vista como não considerando o contexto',3),
    (exortacao_id,'A ênfase na ação específica talvez se veja como não levando em conta os sentimentos da pessoa a quem está aconselhando',4)
  on conflict (gift_id,order_sequence) do nothing;

  -- CONTRIBUIÇÃO - 4 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (contribuicao_id,'A necessidade de lidar com grandes somas de dinheiro, talvez se veja como dando muito valor às coisas materiais',1),
    (contribuicao_id,'O desejo de levar uma obra a maior efetividade através de um donativo pode ser visto como tentando controlar ou dominar a obra',2),
    (contribuicao_id,'A tentativa de motivar outros a contribuir pode ser vista como um modo de se esquivar e como pressão para que os outros dêem',3),
    (contribuicao_id,'A vida simples, frugal, talvez pareça avareza, pão durismo aos olhos de parentes e amigos, pelo fato de não estarem recebendo dele o que desejariam',4)
  on conflict (gift_id,order_sequence) do nothing;

  -- ADMINISTRAÇÃO - 5 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (administracao_id,'A capacidade de distribuir responsabilidades pode ser vista como ociosidade',1),
    (administracao_id,'A disposição de suportar reações negativas pode ser vista como insensibilidade',2),
    (administracao_id,'O não explicar o porquê do serviço pode levar os outros se sentirem como meros instrumentos',3),
    (administracao_id,'O uso de pessoas como recurso pode levá-los a pensar que ele julga o projeto mais importante do que eles',4),
    (administracao_id,'O desejo de completar logo um serviço pode ser visto como não considerando o horário e cansaço e as demais responsabilidades daqueles a quem está liderando',5)
  on conflict (gift_id,order_sequence) do nothing;

  -- MISERICÓRDIA - 4 mal-entendidos
  insert into public.misunderstandings(gift_id,misunderstanding,order_sequence) values
    (misericordia_id,'A falta de autoridade no agir pode ser vista como insegurança ou indecisão',1),
    (misericordia_id,'Ser sensível a sentimentos alheios pode ser visto como viver segurado as emoções e não pelo bom senso',2),
    (misericordia_id,'A compreensão e atração por pessoas necessitadas talvez sejam mal entendidas pelos outros do sexo oposto',3),
    (misericordia_id,'A reação diante de palavras e ações que possam ferir uma terceira pessoa talvez pareça intromissão na vida alheia',4)
  on conflict (gift_id,order_sequence) do nothing;
end$$;

-- MINISTÉRIOS COMPLETOS (do PDF)
do $$
declare
  ministerios_cat_id int;
begin
  select id into ministerios_cat_id from public.categories where name = 'MINISTÉRIOS';
  
  if ministerios_cat_id is not null then
    -- Ministérios Primários
    insert into public.ministries(name,definition,biblical_references,type) values
      ('APÓSTOLO','Alguém enviado pela igreja para um serviço cristão específico','I Co 12:27-28; Ef 4:11','PRIMARY'),
      ('PROFETA','Alguém que proclama a mensagem de Deus principalmente aos crentes','I Co 12:27-28; Ef 4:11','PRIMARY'),
      ('EVANGELISTA','Alguém que proclama a mensagem de Deus aos inconversos','I Co 12:27-28; Ef 4:11','PRIMARY'),
      ('PASTOR','Alguém que supervisiona um grupo de crentes e cuida das suas necessidades','I Co 12:27-28; Ef 4:11','PRIMARY'),
      ('MESTRE','Alguém que esclarece e preserva a Verdade','I Co 12:27-28; Ef 4:11','PRIMARY')
    on conflict (name) do update
    set definition=excluded.definition, biblical_references=excluded.biblical_references, type=excluded.type;

    -- Outros Ministérios
    insert into public.ministries(name,definition,biblical_references,type) values
      ('OPERADORES DE MILAGRES','Alguém que opera sinais e prodígios','I Co 12:28','OTHER'),
      ('DONS DE CURAR','Alguém que opera curas','I Co 12:28','OTHER'),
      ('SOCORROS','Alguém que assiste a liderança no ministério aos necessitados','I Co 12:28','OTHER'),
      ('GOVERNOS','Alguém que guia e dirige a Igreja Local, ou outra obra','I Co 12:28','OTHER'),
      ('VARIEDADE DE LÍNGUAS','Alguém que fala várias línguas pelo Espírito (Interpretação implícita)','I Co 12:28','OTHER'),
      ('PRESBÍTERO','Alguém que cuida da parte espiritual da igreja','I Tm; Tt','OTHER'),
      ('DIÁCONO','Alguém separado para servir','I Tm; Tt','OTHER')
    on conflict (name) do update
    set definition=excluded.definition, biblical_references=excluded.biblical_references, type=excluded.type;
  end if;
end$$;

-- MANIFESTAÇÕES COMPLETAS (do PDF)
do $$
begin
  -- Dons de Discernimento (Revelação)
  insert into public.manifestations(name,definition,classification,biblical_references) values
    ('PALAVRA DE SABEDORIA','Uma revelação do Espírito mostrando como agir em determinada situação','DISCERNIMENTO','I Co 12:7-11'),
    ('PALAVRA DE CONHECIMENTO','Uma revelação do Espírito mostrando algo desconhecido','DISCERNIMENTO','I Co 12:7-11'),
    ('DISCERNIMENTO DE ESPÍRITOS','Capacidade sobrenatural de discernir as atitudes e manifestações de Deus, do homem ou do diabo','DISCERNIMENTO','I Co 12:7-11')
  on conflict (name) do update
  set definition=excluded.definition, classification=excluded.classification, biblical_references=excluded.biblical_references;

  -- Dons de Poder
  insert into public.manifestations(name,definition,classification,biblical_references) values
    ('FÉ','O poder de visualizar algo que Deus quer operar e crer para que aconteça','PODER','I Co 12:7-11'),
    ('DONS DE CURAR','O poder do Espírito curando e trazendo saúde pela aplicação da Verdade','PODER','I Co 12:7-11'),
    ('OPERAÇÃO DE MILAGRES','Prodígios e maravilhas operados pelo poder do Espírito','PODER','I Co 12:7-11')
  on conflict (name) do update
  set definition=excluded.definition, classification=excluded.classification, biblical_references=excluded.biblical_references;

  -- Dons Declarantes (Expressão)
  insert into public.manifestations(name,definition,classification,biblical_references) values
    ('PROFECIA','O Espírito falando através de alguém para a edificação, exortação e consolação de outros','DECLARACAO','I Co 12:7-11'),
    ('VARIEDADE DE LÍNGUAS','Capacidade sobrenatural de adorar a Deus em línguas desconhecidas','DECLARACAO','I Co 12:7-11'),
    ('INTERPRETAÇÃO DE LÍNGUAS','A interpretação de Verdades faladas em línguas desconhecidas','DECLARACAO','I Co 12:7-11')
  on conflict (name) do update
  set definition=excluded.definition, classification=excluded.classification, biblical_references=excluded.biblical_references;
end$$;

-- PRINCÍPIOS DAS MANIFESTAÇÕES (do PDF)
insert into public.manifestation_principles(principle,order_sequence) values
  ('Exercer fé',1),
  ('Aumentar ou ir aumentando à medida do ministério',2),
  ('Falar ao ministério responsável',3),
  ('Sob a autoridade do corpo',4)
on conflict (order_sequence) do update
set principle=excluded.principle;

-- ATIVIDADES BÍBLICAS (do PDF)
insert into public.biblical_activities(activity_name,biblical_reference,biblical_text) values
  ('Declaração da verdade','I Co 14:1; II Tm 4:2','"Segui o amor, e procurai com zelo os dons espirituais, mas principalmente que profetizeis"'),
  ('Serviços','Gl 5:13; Gl 3:23-24','"... sede, antes, servos uns dos outros, pelo amor" - "Tudo quanto fizerdes, fazei-o de todo coração"'),
  ('Ensino','Gl 3:16','"... instruí-vos e aconselhai-vos mutuamente em toda a sabedoria..."'),
  ('Exortação','Hb 3:13','"... exortai-vos mutuamente cada dia..."'),
  ('Contribuição','Mt 10:8; Lc 6:38; Rm 12:13','"... de graça recebeste, de graça daí" - "... daí, e dar-se-vos-a..." - "... Compartilhai as necessidades dos santos..."'),
  ('Administração','I Tm 3:4; Pv 17:2; 16:32; Ef 6:4','"... e que governe bem a sua própria casa..."'),
  ('Misericórdia','Lc 10:33-37; Gl 3:12; Gl 6:2','Jesus ilustrou a misericórdia na história do bom samaritano - "Revesti-vos... de afetos da misericórdia..." - "Levai as cargas uns dos outros"')
on conflict (activity_name) do update
set biblical_reference=excluded.biblical_reference, biblical_text=excluded.biblical_text;

-- QUESTÕES COMPLETAS DO QUIZ (do PDF)
insert into public.questions(id,text) values
  (1,'Gosto de apresentar a verdade de Deus numa forma interessante e entusiasta.'),
  (2,'Estou sempre pronto para colocar em posição secundária meu conforto pessoal a fim de que as necessidades alheias sejam satisfeitas.'),
  (3,'Tenho facilidade para explorar a verdade de um texto dentro do seu contexto.'),
  (4,'Procuro incentivar individualmente os que vacilam e tem problemas espirituais.'),
  (5,'Administro meu dinheiro, mesmo quando pouco, de modo a separar uma quantia generosa para o trabalho de Deus.'),
  (6,'Acho fácil delegar responsabilidades e preparar outras pessoas para realizações no campo espiritual.'),
  (7,'Sou muito sensível às necessidades dos outros.'),
  (8,'Acho fácil falar de Jesus para não crentes.'),
  (9,'Gosto de acompanhar cristãos para ajudá-los no seu crescimento espiritual.'),
  (10,'Quando tento persuadir pessoas a respeito de suas reais motivações, faço-o de modo muito convincente.'),
  (11,'Consigo levar pessoas a se sentirem à vontade na minha presença.'),
  (12,'Sinto grande impulso para descobrir conceitos bíblicos e repassá-los a outros.'),
  (13,'Sempre estou interessado e procuro ajudar o crescimento espiritual das pessoas e levá-las a serem ativas na obra de Deus.'),
  (14,'Alegro-me em dar recursos materiais, de sorte que a obra do Senhor possa ser promovida.'),
  (15,'Sou eficiente em supervisionar as atividades dos outros.'),
  (16,'Gosto de visitar pessoas hospitalizadas ou que não podem sair de casa.'),
  (17,'Já tive experiências de levar outros à fé em Jesus.'),
  (18,'Tenho experiência de levar cristãos a permanecerem firmes na fé devido ao meu acompanhamento.'),
  (19,'Posso apresentar a Palavra de Deus a uma congregação de pessoas com clareza a ponto de serem trazidas à luz verdades escondidas.'),
  (20,'Sinto-me feliz quando solicitado a dar assistência a outros na obra do Senhor sem necessariamente ser indicado para um posto de liderança.'),
  (21,'Sou muito interessado em apresentar conceitos bíblicos de modo bem claro, dando especial atenção a definição de palavras importantes no texto.'),
  (22,'Sinto-me feliz por poder tratar as pessoas feridas espiritualmente.'),
  (23,'Não tenho nenhum problema em confiar os meus recursos a outros para a obra do ministério.'),
  (24,'Posso planejar as ações de outras pessoas, com calma, e dar-lhes os detalhes que as capacitem a trabalhar com eficiência.'),
  (25,'Tenho grande interesse pelos que se acham envolvidos em dificuldades.'),
  (26,'Considero um grande problema o fato de muitos cristãos não falarem aos outros da sua fé em Jesus.'),
  (27,'Preocupo-me com o fato de que muitos cristãos não receberem um acompanhamento na sua vida pessoal e espiritual.'),
  (28,'Esforço-me grandemente para obter resultados, sempre que apresento as verdades da Palavra de Deus.'),
  (29,'Sinto-me bem quando proporciono um agradável acolhimento aos hóspedes.'),
  (30,'Sou diligente em meu estudo da Bíblia e dispenso cuidadosa atenção à necessária pesquisa, não apenas para mostrar sabedoria, mas porque eu gosto.'),
  (31,'Julgo poder ajudar os que têm necessidades de aconselhamento sobre problemas pessoais.'),
  (32,'Preocupo-me em saber que o trabalho de assistência social está sendo suprido de recursos.'),
  (33,'Procuro estar ciente dos recursos disponíveis para a execução das tarefas que tenho que realizar.'),
  (34,'Sinto-me feliz quando consigo atingir pessoas geralmente esquecidas pelos outros.'),
  (35,'Para mim é fácil perceber quando uma pessoa está aberta a aceitar o evangelho.'),
  (36,'É fácil, para mim, acompanhar pessoalmente um grupo de cristãos e me empenhar pela sua unidade.'),
  (37,'Verifico que minha pregação leve pessoas a um ponto de decisão definido.'),
  (38,'Gosto de aliviar a carga das pessoas que ocupam uma posição-chave, de sorte que possam esforçar-se mais em tarefas a elas concernentes.'),
  (39,'Posso explicar bem como a Bíblia mantém sua unidade.'),
  (40,'Sou agudamente consciente das coisas que impedem as pessoas em seu desenvolvimento espiritual e anseio por ajudá-las a vencer seus problemas.'),
  (41,'Sou cuidadoso com a questão de dinheiro e oro continuamente acerca de sua distribuição adequada na obra do Senhor.'),
  (42,'Tenho objetivos bem definidos e consigo levar outros a assumirem meus objetivos.'),
  (43,'Posso relacionar-me com outras pessoas emocionalmente e me disponho a ajudá-las quando for necessário.'),
  (44,'Estou disposto a freqüentar um curso preparatório para o evangelismo.'),
  (45,'Estou disposto a assumir a responsabilidade por um grupo de irmãos.')
on conflict (id) do update set text=excluded.text;

-- MAPEAMENTO DAS QUESTÕES PARA OS DONS (blocos de 5)
do $$
begin
  -- A - PROFECIA: questões 1,10,19,28,37
  insert into public.question_gift_map(question_id,gift) values
    (1,'A_PROPHECY'), (10,'A_PROPHECY'), (19,'A_PROPHECY'), (28,'A_PROPHECY'), (37,'A_PROPHECY')
  on conflict (question_id) do update set gift=excluded.gift;

  -- B - MINISTÉRIO: questões 2,11,20,29,38
  insert into public.question_gift_map(question_id,gift) values
    (2,'B_SERVICE'), (11,'B_SERVICE'), (20,'B_SERVICE'), (29,'B_SERVICE'), (38,'B_SERVICE')
  on conflict (question_id) do update set gift=excluded.gift;

  -- C - ENSINO: questões 3,12,21,30,39
  insert into public.question_gift_map(question_id,gift) values
    (3,'C_TEACHING'), (12,'C_TEACHING'), (21,'C_TEACHING'), (30,'C_TEACHING'), (39,'C_TEACHING')
  on conflict (question_id) do update set gift=excluded.gift;

  -- D - EXORTAÇÃO: questões 4,13,22,31,40
  insert into public.question_gift_map(question_id,gift) values
    (4,'D_EXHORTATION'), (13,'D_EXHORTATION'), (22,'D_EXHORTATION'), (31,'D_EXHORTATION'), (40,'D_EXHORTATION')
  on conflict (question_id) do update set gift=excluded.gift;

  -- E - CONTRIBUIÇÃO: questões 5,14,23,32,41
  insert into public.question_gift_map(question_id,gift) values
    (5,'E_GIVING'), (14,'E_GIVING'), (23,'E_GIVING'), (32,'E_GIVING'), (41,'E_GIVING')
  on conflict (question_id) do update set gift=excluded.gift;

  -- F - ADMINISTRAÇÃO: questões 6,15,24,33,42
  insert into public.question_gift_map(question_id,gift) values
    (6,'F_LEADERSHIP'), (15,'F_LEADERSHIP'), (24,'F_LEADERSHIP'), (33,'F_LEADERSHIP'), (42,'F_LEADERSHIP')
  on conflict (question_id) do update set gift=excluded.gift;

  -- G - MISERICÓRDIA: questões 7,16,25,34,43
  insert into public.question_gift_map(question_id,gift) values
    (7,'G_MERCY'), (16,'G_MERCY'), (25,'G_MERCY'), (34,'G_MERCY'), (43,'G_MERCY')
  on conflict (question_id) do update set gift=excluded.gift;
end$$;

-- GIFTS TABLE (for compatibility)
insert into public.gifts(key,name,description) values
  ('A_PROPHECY','Profecia','Proclamar a verdade com clareza e convicção'),
  ('B_SERVICE','Ministério (Serviço)','Apoio prático e auxilio aos outros'),
  ('C_TEACHING','Ensino','Explicar a verdade fielmente e com clareza'),
  ('D_EXHORTATION','Exortação','Encorajar e aconselhar rumo à ação'),
  ('E_GIVING','Contribuição','Compartilhar recursos generosamente'),
  ('F_LEADERSHIP','Administração','Organizar e guiar rumo aos objetivos'),
  ('G_MERCY','Misericórdia','Cuidar dos feridos e negligenciados')
on conflict (key) do update
set name=excluded.name, description=excluded.description;

-- DONE! Arquivo completo com todos os dados do PDF